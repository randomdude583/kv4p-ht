@startuml

|Radio|
start
:loop;
:ReadByte;

if (MessageType is MSG ?) then (yes)
|CommandProcessor|
:Read CMD MSG Length;
:Determine Command Type;
|Radio|
:ChangeState;
else (no)
|AudioProcessor|
:Determine DataLength;

repeat
  :Read Serial into Buffer;
repeat while (Data Read < DataLength)

|AudioProcessor|
:write Buffer to Encoded Input Stream;
:Copy available bytes to outputStream;
endif
|Radio|
stop

@enduml
